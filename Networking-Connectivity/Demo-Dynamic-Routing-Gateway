# 🎥 Demonstration: Dynamic Routing Gateway (DRG)

## 🌍 Step 1: Navigate to DRG
- Region: **Phoenix**
- Go to: **Navigation Menu → Networking → Dynamic Routing Gateway**
- Initially, no DRG exists.

---

## 🛠️ Step 2: Create a DRG
- Name: `DemoDRG`  
- Click **Create Dynamic Routing Gateway**  
- Wait until the DRG is **Available** ✅

---

## 🔗 Step 3: Explore Attachments
Types of supported attachments under **Resources**:
- VCN Attachments
- FastConnect Virtual Circuits
- IPsec Tunnel Attachments (Site-to-Site VPN)
- Remote Peering Connections (RPC)
- Loopback Attachments
- Cross-Tenancy Attachments  

---

## 📑 Step 4: DRG Route Tables
- Two route tables are autogenerated:
  1. For **RPC, Virtual Circuits, and IPsec attachments**
  2. For **VCN attachments**

- Each route table has an **autogenerated Import Route Distribution**:
  - VCN attachments → **All Routes**
  - Other attachments → **VCN Routes**

- Route tables can include:
  - **Static Routes** (manually added)  
  - **Dynamic Routes** (via import distributions)  

---

## 🖇️ Step 5: Create a VCN Attachment
- Go to **VCN Attachments → Create VCN Attachment**  
- Select **Prod-VCN** → Attach  
- Result: Life cycle state = **Attached**  

### Check Route Rules:
- Initially: No static rules  
- After attaching **Prod-VCN**:  
  - `Get all route rules` → Shows **2 rules** (for the 2 subnets in Prod-VCN)

---

## 🖇️ Step 6: Attach Another VCN
- Create another attachment → **Test-VCN**  
- Result: Life cycle state = **Attached**  

### Check Route Rules:
- Now `Get all route rules` → **4 rules** (2 from Prod-VCN + 2 from Test-VCN)

---

## 🔀 Step 7: Import Route Distributions
- By default, **2 Import Route Distributions** exist:
  1. For **VCN routes** (attachment type = VCN → import)  
  2. For **All routes** (match all)  

---

## 🌐 Step 8: Create Remote Peering Connection (Phoenix ↔ Sydney)
1. In **Phoenix**:
   - Go to **DemoDRG → Remote Peering Connection → Create RPC**  
   - Name: `RPC-Phoenix`  

2. In **Sydney**:
   - Create **DRG-Sydney**  
   - Attach a VCN  
   - Create `RPC-Sydney`  

3. Establish Connection:
   - Copy **Phoenix RPC OCID**  
   - In **Sydney**, establish connection with **Phoenix RPC OCID**  
   - Status: **Peering in progress → Peered** ✅  

---

## 🛣️ Step 9: Verify Route Rules
- **Phoenix DRG → Route Tables**:
  - VCN route table → Still **4 rules**  
  - Other attachments route table → Remains **4 rules**, because import distribution was restricted to VCN routes only.  

- Remote peering route is **not imported** unless explicitly configured in import distributions.

---

## ⚙️ Step 10: Create a Custom Import Route Distribution
- Define **priority** (lower number = higher priority)  
- Options:
  - Match by **Attachment Type** (e.g., Virtual Circuit, VCN, RPC)  
  - Match by **Specific Attachment**  
  - Or **Match All**  
- Action: **Accept**  
- Associate this distribution with a DRG route table  

---

## 🔁 Step 11: Enable ECMP
- Equal-Cost Multi-Path (ECMP) can be enabled in DRG settings.  
- Useful for load balancing across multiple:
  - IPsec tunnels  
  - FastConnect circuits  

---

## ✅ Summary
In this demo, we covered:
- Creating a DRG (`DemoDRG`)  
- Attaching **VCNs (Prod & Test)**  
- Viewing **autogenerated route tables & import distributions**  
- Establishing a **Remote Peering Connection (Phoenix ↔ Sydney)**  
- Understanding why certain routes appear or not based on **import rules**  
- Creating a **custom import route distribution**  
- Enabling **ECMP** for load balancing  
